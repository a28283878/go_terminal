<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="dist/xterm.css">
    <script src="dist/xterm.js"></script>
    <script src="dist/addons/attach/attach.js"></script>
    <meta charset="UTF-8">
    <title>test</title>
</head>
<body>
<div id="terminal"></div>
<script>
        var term
        var terminalContainer = document.getElementById('terminal')
        //var socket = new WebSocket('ws://192.168.99.100:2376/v1.27/containers/ffaae840f334/attach/ws?logs=0&stream=1&stdin=1&stdout=1&stderr=1');
        var websocket = new WebSocket('ws://127.0.0.1:12345/term');

        function ab2str(buf) {
          return String.fromCharCode.apply(null, new Uint8Array(buf));
        }

        websocket.binaryType = "arraybuffer";
        websocket.onopen = function(evt){
            term = new Terminal();

            term.on('data', function(data) {
                websocket.send(new TextEncoder().encode(data));
            });

            // term.on('resize', function(evt) {
            //     websocket.send(new TextEncoder().encode("\x01" + JSON.stringify({cols: evt.cols, rows: evt.rows})))
            // });

            // term.on('title', function(title) {
            //     document.title = title;
            // });

            term.open(terminalContainer, true);

            websocket.onmessage = function(evt) {
                if (evt.data instanceof ArrayBuffer) {
                        term.write(ab2str(evt.data));
                } else {
                        alert(evt.data)
                }
            }

            websocket.onclose = function(evt) {
                term.write("Session terminated");
                term.destroy();
            }

            websocket.onerror = function(evt) {
                if (typeof console.log == "function") {
                        console.log(evt)
                }
            }
        }
</script>
</body>
</html>